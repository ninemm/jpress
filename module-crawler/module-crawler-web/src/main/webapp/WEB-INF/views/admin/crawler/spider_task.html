#@layer()

#define css()
<link rel="stylesheet" href="#(CPATH)/static/components/switchery/switchery.min.css">
<style>
	.switchery {
		margin-top: 0;
	}
</style>
#end

#define script()
<script src="#(CPATH)/static/components/switchery/switchery.min.js"></script>
<script>
	function doSubmit() {
		ajaxSubmit("#form", function (data) {
			toastr.success('启动任务成功。');
			setTimeout(function () {
				parent.close();
			}, 2000);
		});
	}

	$("#submit").on("click", function () {
		doSubmit();
	})
</script>
#end
#define content()
<section class="content">

	<div class="row">
		<div class="col-xs-12">
			<div class="box-body">
				<form class="form-horizontal form-setting" autocomplete="off"
					  action="#(CPATH)/admin/crawler/task/doSaveAndStart" method="POST" id="form">
					<input type="hidden" name="scheduleTask.spider_id" value="#(id ??)">
					<div class="box-body">
						<div class="form-group">
							<label class="col-sm-2 control-label">任务名称</label>
							<div class="col-sm-10">
							   <input type="input" name="scheduleTask.task_name" class="form-control" value="#(scheduleTask.task_name ??)"
									   placeholder="请填写任务名称，如baidu-task...">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label">任务描述</label>
							<div class="col-sm-10">
							   <textarea rows="2" class="form-control" placeholder="请输入..."
									 name="scheduleTask.task_description">#(scheduleTask.task_description ??)</textarea>
							</div>
						</div>

						<div class="form-group">
							<label class="col-sm-2 control-label">任务类名</label>
							<div class="col-sm-10">
								<select class="form-control" name="scheduleTask.task_class">
									<option value="">--请选择--</option>
									<option value="io.jpress.module.crawler.task.NimaScheduleTask" #selectedIf('io.jpress.module.crawler.task.NimaScheduleTask' == scheduleTask.getTaskClass())>泥马代理</option>
									<option value="io.jpress.module.crawler.task.KuaiScheduleTask" #selectedIf('io.jpress.module.crawler.task.KuaiScheduleTask' == scheduleTask.getTaskClass())>快代理</option>
									<option value="io.jpress.module.crawler.task.XiaoShuScheduleTask" #selectedIf('io.jpress.module.crawler.task.XiaoShuScheduleTask' == scheduleTask.getTaskClass())>小舒代理</option>
									<option value="io.jpress.module.crawler.task.QiYunScheduleTask" #selectedIf('io.jpress.module.crawler.task.QiYunScheduleTask' == scheduleTask.getTaskClass())>旗云代理</option>
									<option value="io.jpress.module.crawler.task.Data5uScheduleTask" #selectedIf('io.jpress.module.crawler.task.Data5uScheduleTask' == scheduleTask.getTaskClass())>无忧代理</option>
									<option value="io.jpress.module.crawler.task.YunScheduleTask" #selectedIf('io.jpress.module.crawler.task.YunScheduleTask' == scheduleTask.getTaskClass())>云代理</option>
									<option value="io.jpress.module.crawler.task.CoderBusyScheduleTask" #selectedIf('io.jpress.module.crawler.task.CoderBusyScheduleTask' == scheduleTask.getTaskClass())>coderbusy</option>
								</select>
							</div>
						</div>

						<div class="form-group">
							<label class="col-sm-2 control-label">cron表达式</label>
							<div class="col-sm-10">
							   <input type="input" name="scheduleTask.cron" class="form-control" value="#(scheduleTask.cron ??)"
									   placeholder="请输入cron表达式...">
								<code> Crontab <br>
									*    *    *    *    *    * <br>
									-    -    -    -    -    - <br>
									|    |    |    |    |    | <br>
									|    |    |    |    |    + 年 [可选]<br>
									|    |    |    |    +----- 星期 (0 - 7) (星期天=0 或 7)<br>
									|    |    |    +---------- 月份 (1 - 12)<br>
									|    |    +--------------- 日期 (1 - 31)<br>
									|    +-------------------- 小时 (0 - 23)<br>
									+------------------------- 分钟 (0 - 59)<br>
								</code>
								<p class="help-block"><a href="http://cron.qqe2.com/" target="_blank"><i class="fa fa-share-alt"></i> 在线Cron表达式生成</a></p>
							</div>
						</div>

						<div class="form-group">
							<label class="col-sm-2 control-label">设置</label>
							<div class="col-sm-10">
								<label class="checkbox-inline">
								   <input type="checkbox" class="switchery" data-for="is_active" #checkedIf(scheduleTask.is_active ??)>
								   <input type="hidden" id="is_active" name="scheduleTask.is_active">是否启用
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" class="switchery" data-for="scheduleTask_is_start" #checkedIf(scheduleTask.is_start ??)>
									<input type="hidden" id="scheduleTask_is_start" name="scheduleTask.is_start"> 是否运行
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" class="switchery" data-for="scheduleTask_is_daemon" #checkedIf(scheduleTask.is_daemon ??)>
									<input type="hidden" id="scheduleTask_is_daemon" name="scheduleTask.is_daemon"> 是否守护进程
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" class="switchery" data-for="scheduleTask_is_distributed" #checkedIf(scheduleTask.is_distributed ??)>
									<input type="hidden" id="scheduleTask_is_distributed" name="scheduleTask.is_distributed"> 是否分布式
								</label>
							</div>
						</div>
					</div>
					<!-- /.box-body -->
					<div class="box-footer">
						<div class="col-sm-offset-2 col-sm-10 submit-block">
							<div class="box-submit">
								<button id="submit" type="button" class="btn btn-primary">提交</button>
								<button type="button" class="btn btn-default" onclick="window.history.go(-1);">返回</button>
							</div>
						</div>
					</div>
					<!-- /.box-footer -->
				</form>
			</div>
		</div>
	</div>
</section>
#end